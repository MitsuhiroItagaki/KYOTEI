-- Databricks notebook source
-- MAGIC %sql
-- MAGIC use catalog main;
-- MAGIC use kyotei_db;

-- COMMAND ----------

-- MAGIC %md ### ２つの特徴量テーブルをマージしてゴールドテーブル作成

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC create or replace table training_gold as
-- MAGIC select 
-- MAGIC distinct 
-- MAGIC  T1.RACEDATE -- 特徴量にはしない
-- MAGIC ,T1.PLACE -- 特徴量にはしない
-- MAGIC ,T1.RACE -- 特徴量にはしない
-- MAGIC
-- MAGIC ,T1.PLAYERID1
-- MAGIC ,T1.PLAYERID2
-- MAGIC ,T1.PLAYERID3
-- MAGIC ,T1.PLAYERID4
-- MAGIC ,T1.PLAYERID5
-- MAGIC ,T1.PLAYERID6
-- MAGIC
-- MAGIC ,T1.CLASS1
-- MAGIC ,T1.CLASS2
-- MAGIC ,T1.CLASS3
-- MAGIC ,T1.CLASS4
-- MAGIC ,T1.CLASS5
-- MAGIC ,T1.CLASS6
-- MAGIC
-- MAGIC ,T1.CLUB1
-- MAGIC ,T1.CLUB2
-- MAGIC ,T1.CLUB3
-- MAGIC ,T1.CLUB4
-- MAGIC ,T1.CLUB5
-- MAGIC ,T1.CLUB6
-- MAGIC
-- MAGIC ,T1.AGE1
-- MAGIC ,T1.AGE2
-- MAGIC ,T1.AGE3
-- MAGIC ,T1.AGE4
-- MAGIC ,T1.AGE5
-- MAGIC ,T1.AGE6
-- MAGIC
-- MAGIC ,T1.WEIGHT1
-- MAGIC ,T1.WEIGHT2
-- MAGIC ,T1.WEIGHT3
-- MAGIC ,T1.WEIGHT4
-- MAGIC ,T1.WEIGHT5
-- MAGIC ,T1.WEIGHT6
-- MAGIC
-- MAGIC ,T1.F1
-- MAGIC ,T1.F2
-- MAGIC ,T1.F3
-- MAGIC ,T1.F4
-- MAGIC ,T1.F5
-- MAGIC ,T1.F6
-- MAGIC
-- MAGIC ,T1.L1
-- MAGIC ,T1.L2
-- MAGIC ,T1.L3
-- MAGIC ,T1.L4
-- MAGIC ,T1.L5
-- MAGIC ,T1.L6
-- MAGIC
-- MAGIC ,T1.WIN1RATE1
-- MAGIC ,T1.WIN1RATE2
-- MAGIC ,T1.WIN1RATE3
-- MAGIC ,T1.WIN1RATE4
-- MAGIC ,T1.WIN1RATE5
-- MAGIC ,T1.WIN1RATE6
-- MAGIC
-- MAGIC ,T1.WIN2RATE1
-- MAGIC ,T1.WIN2RATE2
-- MAGIC ,T1.WIN2RATE3
-- MAGIC ,T1.WIN2RATE4
-- MAGIC ,T1.WIN2RATE5
-- MAGIC ,T1.WIN2RATE6
-- MAGIC
-- MAGIC ,T1.LOCALWIN1RATE1
-- MAGIC ,T1.LOCALWIN1RATE2
-- MAGIC ,T1.LOCALWIN1RATE3
-- MAGIC ,T1.LOCALWIN1RATE4
-- MAGIC ,T1.LOCALWIN1RATE5
-- MAGIC ,T1.LOCALWIN1RATE6
-- MAGIC
-- MAGIC ,T1.LOCALWIN2RATE1
-- MAGIC ,T1.LOCALWIN2RATE2
-- MAGIC ,T1.LOCALWIN2RATE3
-- MAGIC ,T1.LOCALWIN2RATE4
-- MAGIC ,T1.LOCALWIN2RATE5
-- MAGIC ,T1.LOCALWIN2RATE6
-- MAGIC
-- MAGIC ,T1.MOTORWIN2RATE1
-- MAGIC ,T1.MOTORWIN2RATE2
-- MAGIC ,T1.MOTORWIN2RATE3
-- MAGIC ,T1.MOTORWIN2RATE4
-- MAGIC ,T1.MOTORWIN2RATE5
-- MAGIC ,T1.MOTORWIN2RATE6
-- MAGIC
-- MAGIC ,T1.MOTORWIN3RATE1
-- MAGIC ,T1.MOTORWIN3RATE2
-- MAGIC ,T1.MOTORWIN3RATE3
-- MAGIC ,T1.MOTORWIN3RATE4
-- MAGIC ,T1.MOTORWIN3RATE5
-- MAGIC ,T1.MOTORWIN3RATE6
-- MAGIC
-- MAGIC ,T1.BOATWIN2RATE1
-- MAGIC ,T1.BOATWIN2RATE2
-- MAGIC ,T1.BOATWIN2RATE3
-- MAGIC ,T1.BOATWIN2RATE4
-- MAGIC ,T1.BOATWIN2RATE5
-- MAGIC ,T1.BOATWIN2RATE6
-- MAGIC
-- MAGIC ,T1.BOATWIN3RATE1
-- MAGIC ,T1.BOATWIN3RATE2
-- MAGIC ,T1.BOATWIN3RATE3
-- MAGIC ,T1.BOATWIN3RATE4
-- MAGIC ,T1.BOATWIN3RATE5
-- MAGIC ,T1.BOATWIN3RATE6
-- MAGIC
-- MAGIC ,T1.ST_AVG1
-- MAGIC ,T1.ST_AVG2
-- MAGIC ,T1.ST_AVG3
-- MAGIC ,T1.ST_AVG4
-- MAGIC ,T1.ST_AVG5
-- MAGIC ,T1.ST_AVG6
-- MAGIC
-- MAGIC ,T1.COURCE1_RACE_COUNT1
-- MAGIC ,T1.COURCE1_WIN1_RATE1
-- MAGIC ,T1.COURCE1_WIN12_RATE1
-- MAGIC ,T1.COURCE1_WIN123_RATE1
-- MAGIC
-- MAGIC ,T1.COURCE2_RACE_COUNT2
-- MAGIC ,T1.COURCE2_WIN1_RATE2
-- MAGIC ,T1.COURCE2_WIN12_RATE2
-- MAGIC ,T1.COURCE2_WIN123_RATE2
-- MAGIC
-- MAGIC ,T1.COURCE3_RACE_COUNT3
-- MAGIC ,T1.COURCE3_WIN1_RATE3
-- MAGIC ,T1.COURCE3_WIN12_RATE3
-- MAGIC ,T1.COURCE3_WIN123_RATE3
-- MAGIC
-- MAGIC ,T1.COURCE4_RACE_COUNT4
-- MAGIC ,T1.COURCE4_WIN1_RATE4
-- MAGIC ,T1.COURCE4_WIN12_RATE4
-- MAGIC ,T1.COURCE4_WIN123_RATE4
-- MAGIC
-- MAGIC ,T1.COURCE5_RACE_COUNT5
-- MAGIC ,T1.COURCE5_WIN1_RATE5
-- MAGIC ,T1.COURCE5_WIN12_RATE5
-- MAGIC ,T1.COURCE5_WIN123_RATE5
-- MAGIC
-- MAGIC ,T1.COURCE6_RACE_COUNT6
-- MAGIC ,T1.COURCE6_WIN1_RATE6
-- MAGIC ,T1.COURCE6_WIN12_RATE6
-- MAGIC ,T1.COURCE6_WIN123_RATE6
-- MAGIC
-- MAGIC ,T2.COURCE1_LOCAL_RACE_COUNT1
-- MAGIC ,T2.COURCE1_LOCAL_WIN1_RATE1
-- MAGIC ,T2.COURCE1_LOCAL_WIN12_RATE1
-- MAGIC ,T2.COURCE1_LOCAL_WIN123_RATE1
-- MAGIC
-- MAGIC ,T2.COURCE2_LOCAL_RACE_COUNT2
-- MAGIC ,T2.COURCE2_LOCAL_WIN1_RATE2
-- MAGIC ,T2.COURCE2_LOCAL_WIN12_RATE2
-- MAGIC ,T2.COURCE2_LOCAL_WIN123_RATE2
-- MAGIC
-- MAGIC ,T2.COURCE3_LOCAL_RACE_COUNT3
-- MAGIC ,T2.COURCE3_LOCAL_WIN1_RATE3
-- MAGIC ,T2.COURCE3_LOCAL_WIN12_RATE3
-- MAGIC ,T2.COURCE3_LOCAL_WIN123_RATE3
-- MAGIC
-- MAGIC ,T2.COURCE4_LOCAL_RACE_COUNT4
-- MAGIC ,T2.COURCE4_LOCAL_WIN1_RATE4
-- MAGIC ,T2.COURCE4_LOCAL_WIN12_RATE4
-- MAGIC ,T2.COURCE4_LOCAL_WIN123_RATE4
-- MAGIC
-- MAGIC ,T2.COURCE5_LOCAL_RACE_COUNT5
-- MAGIC ,T2.COURCE5_LOCAL_WIN1_RATE5
-- MAGIC ,T2.COURCE5_LOCAL_WIN12_RATE5
-- MAGIC ,T2.COURCE5_LOCAL_WIN123_RATE5
-- MAGIC
-- MAGIC ,T2.COURCE6_LOCAL_RACE_COUNT6
-- MAGIC ,T2.COURCE6_LOCAL_WIN1_RATE6
-- MAGIC ,T2.COURCE6_LOCAL_WIN12_RATE6
-- MAGIC ,T2.COURCE6_LOCAL_WIN123_RATE6
-- MAGIC
-- MAGIC ,T1.TAN
-- MAGIC ,T1.TANK
-- MAGIC ,T1.WIDE1
-- MAGIC ,T1.WIDE1K
-- MAGIC ,T1.WIDE2
-- MAGIC ,T1.WIDE2K
-- MAGIC ,T1.WIDE3
-- MAGIC ,T1.WIDE3K
-- MAGIC ,T1.RENTAN2
-- MAGIC ,T1.RENTAN2K
-- MAGIC ,T1.RENFUKU2
-- MAGIC ,T1.RENFUKU2K
-- MAGIC ,T1.RENTAN3
-- MAGIC ,T1.RENTAN3K
-- MAGIC ,T1.RENFUKU3K
-- MAGIC ,T1.RENFUKU3
-- MAGIC from training_feature1 as T1 inner join training_feature2 as T2
-- MAGIC on  T1.RACEDATE = T2.RACEDATE
-- MAGIC and T1.PLACE = T2.PLACE
-- MAGIC and T1.RACE = T2.RACE
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select * from training_gold;

-- COMMAND ----------

-- DBTITLE 1, データチェック用
select racedate,count(1)
from training_gold
group by racedate order by racedate;

-- COMMAND ----------

-- DBTITLE 1,トレーニング用のベーステーブル
-- MAGIC %sql
-- MAGIC create or replace table training_base as
-- MAGIC select 
-- MAGIC distinct 
-- MAGIC  RACEDATE -- 特徴量にはしない
-- MAGIC ,PLACE -- 特徴量にはしない
-- MAGIC ,RACE -- 特徴量にはしない
-- MAGIC
-- MAGIC -- 特徴量にはしない
-- MAGIC --,PLAYERID1
-- MAGIC --,PLAYERID2
-- MAGIC --,PLAYERID3
-- MAGIC --,PLAYERID4
-- MAGIC --,PLAYERID5
-- MAGIC --,PLAYERID6
-- MAGIC
-- MAGIC ,CLASS1
-- MAGIC ,CLASS2
-- MAGIC ,CLASS3
-- MAGIC ,CLASS4
-- MAGIC ,CLASS5
-- MAGIC ,CLASS6
-- MAGIC
-- MAGIC ,CLUB1
-- MAGIC ,CLUB2
-- MAGIC ,CLUB3
-- MAGIC ,CLUB4
-- MAGIC ,CLUB5
-- MAGIC ,CLUB6
-- MAGIC
-- MAGIC ,AGE1
-- MAGIC ,AGE2
-- MAGIC ,AGE3
-- MAGIC ,AGE4
-- MAGIC ,AGE5
-- MAGIC ,AGE6
-- MAGIC
-- MAGIC ,WEIGHT1
-- MAGIC ,WEIGHT2
-- MAGIC ,WEIGHT3
-- MAGIC ,WEIGHT4
-- MAGIC ,WEIGHT5
-- MAGIC ,WEIGHT6
-- MAGIC
-- MAGIC ,F1
-- MAGIC ,F2
-- MAGIC ,F3
-- MAGIC ,F4
-- MAGIC ,F5
-- MAGIC ,F6
-- MAGIC
-- MAGIC ,L1
-- MAGIC ,L2
-- MAGIC ,L3
-- MAGIC ,L4
-- MAGIC ,L5
-- MAGIC ,L6
-- MAGIC
-- MAGIC -- 特徴量にはしない
-- MAGIC ,WIN1RATE1
-- MAGIC ,WIN1RATE2
-- MAGIC ,WIN1RATE3
-- MAGIC ,WIN1RATE4
-- MAGIC ,WIN1RATE5
-- MAGIC ,WIN1RATE6
-- MAGIC
-- MAGIC ,WIN2RATE1
-- MAGIC ,WIN2RATE2
-- MAGIC ,WIN2RATE3
-- MAGIC ,WIN2RATE4
-- MAGIC ,WIN2RATE5
-- MAGIC ,WIN2RATE6
-- MAGIC
-- MAGIC -- 特徴量にはしない
-- MAGIC ,LOCALWIN1RATE1
-- MAGIC ,LOCALWIN1RATE2
-- MAGIC ,LOCALWIN1RATE3
-- MAGIC ,LOCALWIN1RATE4
-- MAGIC ,LOCALWIN1RATE5
-- MAGIC ,LOCALWIN1RATE6
-- MAGIC
-- MAGIC -- 特徴量にはしない
-- MAGIC ,LOCALWIN2RATE1
-- MAGIC ,LOCALWIN2RATE2
-- MAGIC ,LOCALWIN2RATE3
-- MAGIC ,LOCALWIN2RATE4
-- MAGIC ,LOCALWIN2RATE5
-- MAGIC ,LOCALWIN2RATE6
-- MAGIC
-- MAGIC ,MOTORWIN2RATE1
-- MAGIC ,MOTORWIN2RATE2
-- MAGIC ,MOTORWIN2RATE3
-- MAGIC ,MOTORWIN2RATE4
-- MAGIC ,MOTORWIN2RATE5
-- MAGIC ,MOTORWIN2RATE6
-- MAGIC
-- MAGIC -- 特徴量にはしない
-- MAGIC --,MOTORWIN3RATE1
-- MAGIC --,MOTORWIN3RATE2
-- MAGIC --,MOTORWIN3RATE3
-- MAGIC --,MOTORWIN3RATE4
-- MAGIC --,MOTORWIN3RATE5
-- MAGIC --,MOTORWIN3RATE6
-- MAGIC
-- MAGIC ,BOATWIN2RATE1
-- MAGIC ,BOATWIN2RATE2
-- MAGIC ,BOATWIN2RATE3
-- MAGIC ,BOATWIN2RATE4
-- MAGIC ,BOATWIN2RATE5
-- MAGIC ,BOATWIN2RATE6
-- MAGIC
-- MAGIC --,BOATWIN3RATE1
-- MAGIC --,BOATWIN3RATE2
-- MAGIC --,BOATWIN3RATE3
-- MAGIC --,BOATWIN3RATE4
-- MAGIC --,BOATWIN3RATE5
-- MAGIC --,BOATWIN3RATE6
-- MAGIC
-- MAGIC ,ST_AVG1
-- MAGIC ,ST_AVG2
-- MAGIC ,ST_AVG3
-- MAGIC ,ST_AVG4
-- MAGIC ,ST_AVG5
-- MAGIC ,ST_AVG6
-- MAGIC
-- MAGIC ,COURCE1_RACE_COUNT1
-- MAGIC ,COURCE1_WIN1_RATE1
-- MAGIC ,COURCE1_WIN12_RATE1
-- MAGIC ,COURCE1_WIN123_RATE1
-- MAGIC
-- MAGIC ,COURCE2_RACE_COUNT2
-- MAGIC ,COURCE2_WIN1_RATE2
-- MAGIC ,COURCE2_WIN12_RATE2
-- MAGIC ,COURCE2_WIN123_RATE2
-- MAGIC
-- MAGIC ,COURCE3_RACE_COUNT3
-- MAGIC ,COURCE3_WIN1_RATE3
-- MAGIC ,COURCE3_WIN12_RATE3
-- MAGIC ,COURCE3_WIN123_RATE3
-- MAGIC
-- MAGIC ,COURCE4_RACE_COUNT4
-- MAGIC ,COURCE4_WIN1_RATE4
-- MAGIC ,COURCE4_WIN12_RATE4
-- MAGIC ,COURCE4_WIN123_RATE4
-- MAGIC
-- MAGIC ,COURCE5_RACE_COUNT5
-- MAGIC ,COURCE5_WIN1_RATE5
-- MAGIC ,COURCE5_WIN12_RATE5
-- MAGIC ,COURCE5_WIN123_RATE5
-- MAGIC
-- MAGIC ,COURCE6_RACE_COUNT6
-- MAGIC ,COURCE6_WIN1_RATE6
-- MAGIC ,COURCE6_WIN12_RATE6
-- MAGIC ,COURCE6_WIN123_RATE6
-- MAGIC
-- MAGIC ,COURCE1_LOCAL_RACE_COUNT1
-- MAGIC ,COURCE1_LOCAL_WIN1_RATE1
-- MAGIC ,COURCE1_LOCAL_WIN12_RATE1
-- MAGIC ,COURCE1_LOCAL_WIN123_RATE1
-- MAGIC
-- MAGIC ,COURCE2_LOCAL_RACE_COUNT2
-- MAGIC ,COURCE2_LOCAL_WIN1_RATE2
-- MAGIC ,COURCE2_LOCAL_WIN12_RATE2
-- MAGIC ,COURCE2_LOCAL_WIN123_RATE2
-- MAGIC
-- MAGIC ,COURCE3_LOCAL_RACE_COUNT3
-- MAGIC ,COURCE3_LOCAL_WIN1_RATE3
-- MAGIC ,COURCE3_LOCAL_WIN12_RATE3
-- MAGIC ,COURCE3_LOCAL_WIN123_RATE3
-- MAGIC
-- MAGIC ,COURCE4_LOCAL_RACE_COUNT4
-- MAGIC ,COURCE4_LOCAL_WIN1_RATE4
-- MAGIC ,COURCE4_LOCAL_WIN12_RATE4
-- MAGIC ,COURCE4_LOCAL_WIN123_RATE4
-- MAGIC
-- MAGIC ,COURCE5_LOCAL_RACE_COUNT5
-- MAGIC ,COURCE5_LOCAL_WIN1_RATE5
-- MAGIC ,COURCE5_LOCAL_WIN12_RATE5
-- MAGIC ,COURCE5_LOCAL_WIN123_RATE5
-- MAGIC
-- MAGIC ,COURCE6_LOCAL_RACE_COUNT6
-- MAGIC ,COURCE6_LOCAL_WIN1_RATE6
-- MAGIC ,COURCE6_LOCAL_WIN12_RATE6
-- MAGIC ,COURCE6_LOCAL_WIN123_RATE6
-- MAGIC
-- MAGIC -- case1 一着が１号艇以外だが、１号艇と/2号艇は三着以内に入っている　<--  Trueのレコード件数は５０％ほどになるが、利益が出ない
-- MAGIC --,case when RENFUKU3 like '1=2=%' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case2 一着が１号艇以外だが、１号艇と/2号艇は三着以内に入っている
-- MAGIC -- ,case when TAN not in (1) AND RENFUKU3 like '1=2=%' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case3 １号艇と/2号艇/3号艇は三着以内に入っている 
-- MAGIC --,case when RENFUKU3 like '1=2=3' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case4 
-- MAGIC --,case when RENFUKU2 like '1=2' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case4 
-- MAGIC --,case when RENFUKU2 like '1=3' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case4 
-- MAGIC --,case when RENFUKU2 like '1=4' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case5
-- MAGIC --,case when RENTAN2 like '1>2' THEN 1 else 0 end as BUY
-- MAGIC
-- MAGIC -- case5
-- MAGIC --,case when RENTAN2 like '1>3' THEN 1 else 0 end as BUY5
-- MAGIC
-- MAGIC -- case6
-- MAGIC --,case when RENTAN3 like '1>2>3' THEN 1 else 0 end as BUY4
-- MAGIC
-- MAGIC -- case7 一着が１号艇、１号艇と/2号艇は三着以内に入っている
-- MAGIC --,case when TAN in (1) AND RENFUKU3 like '1=2=%' THEN 1 else 0 end as BUY5
-- MAGIC
-- MAGIC -- case7 一着が１号艇、１号艇と/2号艇は三着以内に入っている
-- MAGIC --,case when TAN in (2) AND RENFUKU3 like '1=2=%' THEN 1 else 0 end as BUY6
-- MAGIC
-- MAGIC -- case7
-- MAGIC ,CAST(CAST(TAN as int) as string) as BUY
-- MAGIC
-- MAGIC ,CAST(CAST(TAN as int) as string) as TAN
-- MAGIC ,TANK
-- MAGIC ,WIDE1
-- MAGIC ,WIDE1K
-- MAGIC ,WIDE2
-- MAGIC ,WIDE2K
-- MAGIC ,WIDE3
-- MAGIC ,WIDE3K
-- MAGIC ,RENTAN2
-- MAGIC ,RENTAN2K
-- MAGIC ,RENFUKU2
-- MAGIC ,RENFUKU2K
-- MAGIC ,RENTAN3
-- MAGIC ,RENTAN3K
-- MAGIC ,RENFUKU3K
-- MAGIC ,RENFUKU3
-- MAGIC from training_gold
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select racedate,count(1) from training_base group by 1 order by 1
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %md ## 一年前から予測対象の明日までのデータセットを取得

-- COMMAND ----------

-- MAGIC %python
-- MAGIC START_DATE = sql("SELECT date_format(date_sub(current_date(), 12 * 30), 'yyyyMMdd') as start").toPandas().to_string(index=False, header=False)
-- MAGIC print(START_DATE)

-- COMMAND ----------

-- MAGIC %python
-- MAGIC END_DATE = sql("SELECT date_format(DATE_ADD(current_date(),1), 'yyyyMMdd') as tomorrow_date").toPandas().to_string(index=False, header=False)
-- MAGIC print(END_DATE)

-- COMMAND ----------

-- MAGIC %python
-- MAGIC sqltext=f"""
-- MAGIC create or replace table training
-- MAGIC as 
-- MAGIC select 
-- MAGIC *
-- MAGIC from training_base
-- MAGIC --where racedate between '20220801' and '20230731' -- 明示的に指定する場合
-- MAGIC where racedate between '20220101' and '20230731' -- 明示的に指定する場合
-- MAGIC and   rentan2 is not null -- NULLデータは含まないので当日データは含まれない
-- MAGIC """
-- MAGIC print(sqltext)
-- MAGIC
-- MAGIC # 実行
-- MAGIC sql(sqltext)

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select racedate,count(1) from training group by 1 order by 1
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select * from training order by 1

-- COMMAND ----------

-- MAGIC %md ##  予測データ作成

-- COMMAND ----------

-- MAGIC %python
-- MAGIC sqltext=f"""
-- MAGIC create or replace table predict
-- MAGIC as 
-- MAGIC select 
-- MAGIC *
-- MAGIC from training_base
-- MAGIC where racedate between '20230801' and '20231130' -- 明示的に指定する場合
-- MAGIC --where racedate = '{END_DATE}' 
-- MAGIC --and  rentan3 is null -- 当日データは結果がNULLなのでNULLを含むデータを指定
-- MAGIC """
-- MAGIC print(sqltext)
-- MAGIC
-- MAGIC # 実行
-- MAGIC sql(sqltext)

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select racedate,count(1) from predict group by 1 order by 1
-- MAGIC ;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select * from predict;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select min(racedate), max(racedate),count(1) from  training;

-- COMMAND ----------

-- MAGIC %sql
-- MAGIC select min(racedate), max(racedate),count(1) from  predict;
